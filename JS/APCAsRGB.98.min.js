/*

/////   APCA - Advanced Perceptual Contrast - Beta Algorithm 0.98
/////              *** WITH Low Contrast Extension ***
/////        *** Optimized for the Font Select Extension ***
/////
/////   Functions to parse color values and determine SAPC/APCA contrast
/////   Copyright Â© 2019-2020 by Andrew Somers. All Rights Reserved.
/////   APCA version licensed to W3 per collaborator agreement
/////   LICENSE: GNU AGPL v3  https://www.gnu.org/licenses/
/////   CONTACT: For SAPC/APCA Please use the ISSUES tab at:
/////   https://github.com/Myndex/SAPC-APCA/
*/
var sRGBtrc=2.218,sRGBtrcEncode=1/sRGBtrc,Rco=.2126,Gco=.7152,Bco=.0722,scaleBoW=1.618,scaleWoB=1.618,normBGExp=.38,normTXTExp=.43,revBGExp=.5,revTXTExp=.43,blkThrs=.02,blkClmp=1.33,loConThresh=.25,clipLevel=.1;function loConRamp(d,h,k,n,g,p){k=void 0===k?.4:k;var r=!1;0>d&&(r=!0,d=Math.abs(d));d=Math.max(0,d-Math.min(void 0===p?.095:p,Math.max(0,2-Math.abs(Math.cos(Math.pow(void 0===h?1:h,.25)*(void 0===n?2.8:n)))-(void 0===g?.6:g))*Math.max(0,Math.min(.1,(k-d)/(k-.1)*.1))));return r?-1*d:d}
function APCAcontrast(d,h,k){k=void 0===k?1:k;var n="";d=d.LYP;var g=h.LYP;if(d>=g){g=g>blkThrs?g:g+Math.pow(Math.abs(g-blkThrs),blkClmp);if(g>d)return"Error";h=(Math.pow(d,normBGExp)-Math.pow(g,normTXTExp))*scaleBoW;d=h>=loConThresh?h:loConRamp(h,d,loConThresh)}else{d=d>blkThrs?d:d+Math.pow(Math.abs(d-blkThrs),blkClmp);if(d>g)return"-Error";h=(Math.pow(d,revBGExp)-Math.pow(g,revTXTExp))*scaleWoB;n="-";d=h<=-loConThresh?h:loConRamp(h,g,loConThresh,2.6,.53,.11)}return d>clipLevel||d<-clipLevel?(100*
d).toFixed(k)+"":n+"LOW"}
function RGBcolor(d){function h(a){a/=255;return.04045<a?Math.pow((a+.055)/1.055,2.4):a/12.92}function k(a){return.008856451679035631<a?116*Math.pow(a,.3333333333333333)-16:903.2962962962963*a}function n(a){return.008856451679035631<a?Math.pow(a,.3333333333333333):.008620689655172414*(903.2962962962963*a+16)}function g(a,b){var c=Math.pow(a*a+b*b,.5),e=.01>c?0:57.29577951308232*Math.atan2(b,a);return[c,0>e?e+360:e]}d=(void 0===d?"777":d).replace(/[\s `~!@#$%^&*<>?{}:;"'+=-]/g,"");this.cleaned=d=d.toLowerCase();
var p={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkorange:"ff8c00",darksalmon:"e9967a",darkseagreen:"8fbc8f",
deepskyblue:"00bfff",dodgerblue:"1e90ff",feldspar:"d19275",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorchid:"9932cc",darkred:"8b0000",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",dimgray:"696969",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",
honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",
limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",
palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",
tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32",zzzcontrol1:"111111",zzzcontrol2:"222222",zzzcontrol3:"333333",zzzcontrol4:"444444",zzzcontrol5:"555555",zzzcontrol6:"666666",zzzcontrol7:"777777",zzzcontrol8:"888888",zzzcontrol9:"999999",zzzcontrola:"aaaaaa",zzzcontrolb:"bbbbbb",zzzcontrolc:"cccccc",zzzcontrold:"dddddd",zzzcontrole:"eeeeee"};for(r in p)d==r&&(d=p[r]);p=[{regex:/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/,
example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{regex:/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),(\d{1,3})\)$/,example:["rgba(123,234,45,128)","rgba(255,234,245,233)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]}},{regex:/^([0-9|a-f]{2})$/,example:["fe","73"],process:function(a){return[parseInt(a[1],16),parseInt(a[1],16),parseInt(a[1],16)]}},{regex:/^([0-9|a-f]{1})([0-9|a-f]{1})([0-9|a-f]{1})$/,
example:["fb0","b0b"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{regex:/^([0-9|a-f]{1})([0-9|a-f]{1})([0-9|a-f]{1})([0-9|a-f]{1})$/,example:["fb0F","b0b8"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16),parseInt(a[4]+a[4],16)]}},{regex:/^([0-9|a-f]{2})([0-9|a-f]{2})([0-9|a-f]{2})$/,example:["05f3a0","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},
{regex:/^([0-9|a-f]{2})([0-9|a-f]{2})([0-9|a-f]{2})([0-9|a-f]{2})$/,example:["05f3a0ff","336699aa"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),parseInt(a[4],16)]}}];var r=p.length;this.ok=!1;for(var t=0;t<r&&0==this.ok;t++){var q=p[t].regex;if(q=q.exec(d))q=p[t].process(q),this.r=q[0]&255,this.g=q[1]&255,this.b=q[2]&255,isNaN(q[3])?this.a="":this.a=q[3]&255,this.ok=!0}if(this.ok){this.hex=function(a,b,c,e){a=void 0===a?this.r:a;b=void 0===b?this.g:b;c=void 0===
c?this.b:c;e=void 0===e?this.a:e;a=a.toString(16).padStart(2,"0");b=b.toString(16).padStart(2,"0");c=c.toString(16).padStart(2,"0");e=""===e?"":e.toString(16).padStart(2,"0");return a+b+c+e};this.hex2=function(){var a=this.r.toString(16).padStart(2,"0"),b=this.g.toString(16).padStart(2,"0"),c=this.b.toString(16).padStart(2,"0"),e=""===this.a?"":this.a.toString(16).padStart(2,"0");return 0==this.r%17&&0==this.g%17&&0==this.b%17&&0==this.a%17?a.charAt(0)+b.charAt(0)+c.charAt(0)+e.charAt(0):a+b+c+e};
this.hexNoA=function(a,b,c){a=void 0===a?this.r:a;b=void 0===b?this.g:b;c=void 0===c?this.b:c;a=a.toString(16).padStart(2,"0");b=b.toString(16).padStart(2,"0");c=c.toString(16).padStart(2,"0");return"#"+a+b+c};this.hexNoA2=function(){var a=this.r.toString(16).padStart(2,"0"),b=this.g.toString(16).padStart(2,"0"),c=this.b.toString(16).padStart(2,"0");return 0==this.r%17&&0==this.g%17&&0==this.b%17?"#"+a.charAt(0)+b.charAt(0)+c.charAt(0):"#"+a+b+c};this.RGBAstr=function(){return""==this.a?"rgb("+this.r+
","+this.g+","+this.b+")":"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"};this.RGBstr=function(){return"rgb( "+this.r+", "+this.g+", "+this.b+" )"};this.RGBAhex=function(){return""==this.a?this.r<<24|this.g<<16|this.b<<8|255:this.r<<24|this.g<<16|this.b<<8|this.a};this.RGBhex=function(){return this.r<<16|this.g<<8|this.b};this.decRGBstr=function(a){a=void 0===a?3:a;return"rgb("+(this.r/255).toFixed(a)+","+(this.g/255).toFixed(a)+","+(this.b/255).toFixed(a)+")"};this.decRGBAstr=function(a){a=
void 0===a?4:a;return""===this.a?"rgb("+(this.r/255).toPrecision(a).substr(0,a+4)+","+(this.g/255).toPrecision(a).substr(0,a+4)+","+(this.b/255).toPrecision(a).substr(0,a+4)+")":"rgba("+(this.r/255).toPrecision(a).substr(0,a+4)+","+(this.g/255).toPrecision(a).substr(0,a+4)+","+(this.b/255).toPrecision(a).substr(0,a+4)+","+(this.a/255).toPrecision(a).substr(0,a+4)+")"};this.decRGBarray=function(){return[this.r/255,this.g/255,this.b/255]};this.decRGBAarray=function(){return""===this.a?[this.r/255,this.g/
255,this.b/255,1]:[this.r/255,this.g/255,this.b/255,this.a/255]};var v=!1;v=!0;this.RlinP=Math.pow(this.r/255,sRGBtrc);this.GlinP=Math.pow(this.g/255,sRGBtrc);this.BlinP=Math.pow(this.b/255,sRGBtrc);this.RlinCoP=Rco*this.RlinP;this.GlinCoP=Gco*this.GlinP;this.BlinCoP=Bco*this.BlinP;this.LYP=this.RlinCoP+this.GlinCoP+this.BlinCoP;this.LY100P=100*this.LYP;this.Rlin=function(a){a=void 0===a?sRGBtrc:a;return Math.pow(this.r/255,a)};this.Glin=function(a){a=void 0===a?sRGBtrc:a;return Math.pow(this.g/255,
a)};this.Blin=function(a){a=void 0===a?sRGBtrc:a;return Math.pow(this.b/255,a)};this.RlinCo=function(a,b){a=void 0===a?sRGBtrc:a;b=void 0===b?Rco:b;return b*this.Rlin(a)};this.GlinCo=function(a,b){a=void 0===a?sRGBtrc:a;b=void 0===b?Gco:b;return b*this.Glin(a)};this.BlinCo=function(a,b){a=void 0===a?sRGBtrc:a;b=void 0===b?Bco:b;return b*this.Blin(a)};this.LY=function(a,b,c,e){a=void 0===a?sRGBtrc:a;b=void 0===b?Rco:b;c=void 0===c?Gco:c;e=void 0===e?Bco:e;return this.RlinCo(a,b)+this.GlinCo(a,c)+this.BlinCo(a,
e)};this.LY100=function(a){a=void 0===a?sRGBtrc:a;return 100*this.LY(a)};this.LY100str=function(a){a=void 0===a?4:a;return this.LY100().toPrecision(a).substr(0,a+4)};this.Ls=function(a){a=void 0===a?normTXTExp:a;return 100*Math.pow(this.LY(),a)};this.Lstar=function(a,b){a=void 0===a?this.LYP:a;return k(a/(void 0===b?1:b))};this.LstarStr=function(a,b,c){a=void 0===a?4:a;b=void 0===b?this.LYP:b;return k(b/(void 0===c?1:c)).toPrecision(a).substr(0,a+4)};this.sRlin=function(a){a=void 0===a?this.r:a;return h(a)};
this.sGlin=function(a){a=void 0===a?this.g:a;return h(a)};this.sBlin=function(a){a=void 0===a?this.b:a;return h(a)};this.sRlinCo=function(a){a=void 0===a?Rco:a;return a*this.sRlin()};this.sGlinCo=function(a){a=void 0===a?Gco:a;return a*this.sGlin()};this.sBlinCo=function(a){a=void 0===a?Bco:a;return a*this.sBlin()};this.sLY=function(){return this.sRlinCo()+this.sGlinCo()+this.sBlinCo()};this.sLY100=function(){return 100*this.sLY()};this.sLstar=function(a,b){a=void 0===a?this.sLY():a;return k(a/(void 0===
b?1:b))};var f={Y100:0,Lstar:0,La:0,Lb:0,Lu:0,Lv:0,X:0,Z:0,x:0,y:0,Y:0,Labuv:0,Cab:0,hab:0,Cuv:0,huv:0};this.CIE=function(a,b,c,e,m){a=void 0===a?15:a;switch(void 0===b?"piecewise":b){case 0:case "piecewise":Rlin=this.sRlin();Glin=this.sGlin();Blin=this.sBlin();break;case 1:case "simpleExp":v?(Rlin=this.RlinP,Glin=this.GlinP,Blin=this.BlinP):(Rlin=this.Rlin(),Glin=this.Glin(),Blin=this.Blin());break;case 2:case "int":Rlin=this.sRlin(isNaN(c)?170:c&255);Glin=this.sGlin(isNaN(e)?170:e&255);Blin=this.sBlin(isNaN(m)?
170:m&255);break;case 3:case "intExp":Rlin=this.Rlin(isNaN(c)?128:c&255);Glin=this.Glin(isNaN(e)?128:e&255);Blin=this.Blin(isNaN(m)?128:m&255);break;case 4:case "float":Rlin=isNaN(c)?.184:c;Glin=isNaN(e)?.184:e;Blin=isNaN(m)?.184:m;break;default:Rlin=.496933,Glin=.401978,Blin=.72306}a&=15;b=.4124564*Rlin+.3575761*Glin+.1804375*Blin;c=.2126729*Rlin+.7151522*Glin+.072175*Blin;e=.0193339*Rlin+.119192*Glin+.9503041*Blin;f.X=b;f.Y=c;f.Z=e;f.Y100=100*c;8==(a&8)&&(m=b+c+e,f.x=0<m?b/m:.3127266146810121,f.y=
0<m?c/m:.3290231303260619);if(0!=(a&7)){var l=n(c);f.Lstar=f.Labuv=116*l-16}if(2==(a&2)){var u=.9184170164304805*e;m=n(1.0521110608435826*b);u=n(u);f.La=500*(m-l);f.Lb=200*(l-u)}4==(a&4)&&(l=b+15*c+3*e,f.Lu=13*f.Labuv*((0<l?4*b/l:0)-.19783982482140774),f.Lv=13*f.Labuv*((0<l?9*c/l:0)-.4683363029324097));3==(a&3)&&(l=g(f.La,f.Lb),f.Cab=l[0],f.hab=l[1]);5==(a&5)&&(l=g(f.Lu,f.Lv),f.Cuv=l[0],f.huv=l[1]);return f}}else this.r=this.g=this.b=this.a=0};